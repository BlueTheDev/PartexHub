<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PartexHub Full</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto&family=Montserrat&family=Lobster&family=Open+Sans&family=Pacifico&family=Fira+Code&family=Courier+Prime&display=swap" rel="stylesheet">
<style>
/* ------------------ Grundlayout ------------------ */
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Roboto',sans-serif;background:#f5f5f5;transition:0.3s;}
body.dark{background:#121212;color:white;}
header{background:#1e1e1e;color:white;padding:15px 20px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:1000;}
header h1{font-family:'Montserrat',sans-serif;font-size:28px;}
header .buttons{display:flex;gap:10px;}
header button{padding:6px 12px;border:none;border-radius:6px;background:#ff6b6b;color:white;cursor:pointer;transition:0.3s;font-size:14px;}
header button:hover{background:#ff3b3b;}
.theme-toggle{background:#555;}
.theme-toggle:hover{background:#333;}
.dashboard{display:flex;flex-wrap:wrap;gap:20px;padding:30px;justify-content:center;}
.app-card{background:white;border-radius:15px;padding:20px;width:200px;height:180px;display:flex;flex-direction:column;justify-content:center;align-items:center;box-shadow:0 8px 20px rgba(0,0,0,0.1);cursor:pointer;position:relative;transition:0.3s;}
.app-card:hover{transform:translateY(-6px);box-shadow:0 12px 30px rgba(0,0,0,0.2);}
.app-card h2{margin-top:10px;font-size:18px;font-family:'Montserrat',sans-serif;}
.app-card img{width:50px;height:50px;}
.app-card .tooltip{position:absolute;bottom:-25px;font-size:12px;background:rgba(0,0,0,0.7);color:white;padding:3px 8px;border-radius:5px;opacity:0;pointer-events:none;transition:0.3s;}
.app-card:hover .tooltip{opacity:1;}
#app-container{display:none;padding:20px;}
.menu-bar{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px;}
.menu-bar select,.menu-bar button,.menu-bar input[type=color]{padding:5px 10px;border-radius:5px;border:1px solid #ccc;font-size:14px;cursor:pointer;transition:0.2s;}
.menu-bar button:hover{background:#ddd;}
#editor{width:100%;min-height:400px;border-radius:8px;border:1px solid #ccc;padding:15px;font-size:16px;font-family:'Roboto',sans-serif;line-height:1.5;overflow:auto;outline:none;}
body.dark #editor{background:#1e1e1e;color:white;border:1px solid #444;}
#slides-container{width:100%;min-height:400px;position:relative;background:#fff;border-radius:10px;border:1px solid #ccc;overflow:hidden;display:none;}
.slide{display:none;width:100%;height:100%;padding:20px;font-size:20px;line-height:1.4;font-family:'Roboto',sans-serif;position:absolute;top:0;left:0;transition:all 0.5s;overflow:auto;border-radius:10px;box-shadow:0 0 15px rgba(0,0,0,0.1);}
.slide.active{display:block;}
#settings-panel{display:none;position:fixed;top:60px;right:0;width:300px;background:white;border-left:1px solid #ccc;height:calc(100% - 60px);padding:20px;box-shadow:-4px 0 10px rgba(0,0,0,0.1);z-index:2000;}
body.dark #settings-panel{background:#1e1e1e;color:white;border-left:1px solid #444;}
.setting-item{margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;}
#auth-panel{padding:40px;text-align:center;}
#auth-panel input{padding:8px 12px;margin:5px;width:80%;border-radius:6px;border:1px solid #ccc;font-size:14px;}
#auth-panel button{padding:8px 12px;margin:5px;width:50%;border-radius:6px;border:none;background:#1e90ff;color:white;font-size:14px;cursor:pointer;}
#user-info{margin-bottom:15px;}
</style>
</head>
<body>
<header>
<h1>PartexHub</h1>
<div class="buttons">
<button onclick="goDashboard()">Dashboard</button>
<button class="theme-toggle" onclick="toggleTheme()">Theme</button>
<button onclick="toggleSettings()">Einstellungen</button>
</div>
</header>

<div id="auth-panel">
<div id="user-info"></div>
<input type="email" id="email" placeholder="Email"><br>
<input type="password" id="password" placeholder="Passwort"><br>
<button onclick="signup()">Registrieren</button>
<button onclick="login()">Login</button><br>
<button onclick="googleLogin()">Login mit Google</button>
</div>

<div class="dashboard" id="dashboard" style="display:none;">
<div class="app-card" onclick="openWriter()">
<img src="https://img.icons8.com/ios-filled/50/000000/edit--v1.png"/>
<h2>PartexWriter</h2>
<div class="tooltip">Schreibe Texte wie ein Profi!</div>
</div>
<div class="app-card" onclick="openPresenter()">
<img src="https://img.icons8.com/ios-filled/50/000000/presentation.png"/>
<h2>PartexPresenter</h2>
<div class="tooltip">Erstelle Pr√§sentationen!</div>
</div>
</div>

<div id="app-container">
<!-- Writer Menu -->
<div class="menu-bar" id="writer-menu" style="display:none;">
<select id="font-select" onchange="changeFont()">
<option>Roboto</option><option>Montserrat</option><option>Lobster</option><option>Open Sans</option><option>Pacifico</option><option>Fira Code</option><option>Courier Prime</option>
</select>
<select id="font-size" onchange="changeFontSize()">
<option value="12">12</option><option value="14">14</option><option value="16" selected>16</option><option value="18">18</option><option value="20">20</option><option value="22">22</option><option value="24">24</option><option value="28">28</option><option value="32">32</option>
</select>
<input type="color" id="text-color" onchange="changeColor()" title="Textfarbe">
<input type="color" id="bg-color" onchange="changeBg()" title="Hintergrundfarbe">
<button onclick="boldText()">B</button>
<button onclick="italicText()">I</button>
<button onclick="underlineText()">U</button>
<button onclick="strikeText()">S</button>
<button onclick="alignLeft()">‚¨Ö</button>
<button onclick="alignCenter()">‚Üî</button>
<button onclick="alignRight()">‚û°</button>
<button onclick="justifyText()">‚õ∂</button>
<button onclick="insertBullet()">‚Ä¢ Liste</button>
<button onclick="insertNumber()">1. Liste</button>
<button onclick="insertEmoji()">üòä</button>
<button onclick="undo()">‚Ü∂</button>
<button onclick="redo()">‚Ü∑</button>
<button onclick="saveAs()">Speichern unter</button>
<button onclick="newDocument()">Neu</button>
<button onclick="openDocument()">√ñffnen</button>
</div>

<!-- Writer Editor -->
<div id="editor" contenteditable="true" style="display:none;"></div>

<!-- Presenter -->
<div class="menu-bar" id="presenter-menu" style="display:none;">
<button onclick="prevSlide()">‚Üê</button>
<button onclick="nextSlide()">‚Üí</button>
<button onclick="addSlide()">Neue Folie</button>
<input type="color" id="slide-bg" onchange="changeSlideBg()" title="Hintergrundfarbe">
<button onclick="downloadSlides()">Download</button>
<button onclick="fullscreenSlide()">Vollbild</button>
<button onclick="addTextBox()">Textbox hinzuf√ºgen</button>
<button onclick="removeTextBox()">Textbox entfernen</button>
</div>
<div id="slides-container"></div>

<!-- Settings -->
<div id="settings-panel">
<h3>Einstellungen</h3>
<div class="setting-item">
<label>Autosave Writer</label>
<input type="checkbox" id="autosave-writer" checked>
</div>
<div class="setting-item">
<label>Autosave Presenter</label>
<input type="checkbox" id="autosave-presenter" checked>
</div>
<div class="setting-item">
<label>Default Font</label>
<select id="default-font">
<option>Roboto</option><option>Montserrat</option><option>Lobster</option><option>Open Sans</option>
</select>
</div>
<div class="setting-item">
<label>Default Font Size</label>
<select id="default-size">
<option>16</option><option>18</option><option>20</option>
</select>
</div>
</div>

<script type="module">
// ---------------- Firebase Init ----------------
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBgNiehD0PECNhj3BcT8aRzgN6Q1PyAiWI",
  authDomain: "partexcloud.firebaseapp.com",
  projectId: "partexcloud",
  messagingSenderId: "708155275046",
  appId: "1:708155275046:web:fa7d7d82a06878a8cc33e7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();

// ---------------- Auth Functions ----------------
function updateUI(user){
  const info = document.getElementById('user-info');
  if(user){
    info.innerHTML = `Eingeloggt als: ${user.email} <button onclick="logout()">Logout</button>`;
    document.getElementById('auth-panel').style.display='none';
    goDashboard();
  } else {
    info.innerHTML='';
    document.getElementById('auth-panel').style.display='block';
    document.getElementById('dashboard').style.display='none';
    document.getElementById('app-container').style.display='none';
  }
}

window.signup = function(){
  const email = document.getElementById('email').value;
  const pass = document.getElementById('password').value;
  createUserWithEmailAndPassword(auth,email,pass)
    .then(userCredential=>{updateUI(userCredential.user);})
    .catch(err=>alert(err.message));
};

window.login = function(){
  const email = document.getElementById('email').value;
  const pass = document.getElementById('password').value;
  signInWithEmailAndPassword(auth,email,pass)
    .then(userCredential=>{updateUI(userCredential.user);})
    .catch(err=>alert(err.message));
};

window.googleLogin = function(){
  signInWithPopup(auth, provider)
    .then(result=>{updateUI(result.user);})
    .catch(err=>alert(err.message));
};

window.logout = function(){
  signOut(auth).then(()=>updateUI(null));
};

onAuthStateChanged(auth, user => updateUI(user));

// ---------------- Dashboard & Theme ----------------
function goDashboard(){
  document.getElementById('dashboard').style.display='flex';
  document.getElementById('app-container').style.display='block';
  document.getElementById('writer-menu').style.display='none';
  document.getElementById('presenter-menu').style.display='none';
  document.getElementById('editor').style.display='none';
  document.getElementById('slides-container').style.display='none';
}

function toggleTheme(){document.body.classList.toggle('dark');}
function toggleSettings(){let panel=document.getElementById('settings-panel');panel.style.display=(panel.style.display==='block')?'none':'block';}

// ---------------- Writer ----------------
let undoStack=[],redoStack=[];
function openWriter(){
  document.getElementById('dashboard').style.display='none';
  document.getElementById('app-container').style.display='block';
  document.getElementById('writer-menu').style.display='flex';
  document.getElementById('presenter-menu').style.display='none';
  document.getElementById('editor').style.display='block';
  document.getElementById('slides-container').style.display='none';
  if(localStorage.getItem('partex-content')) document.getElementById('editor').innerHTML=localStorage.getItem('partex-content');
}

function changeFont(){document.getElementById('editor').style.fontFamily=document.getElementById('font-select').value;}
function changeFontSize(){document.getElementById('editor').style.fontSize=document.getElementById('font-size').value+'px';}
function changeColor(){document.execCommand('foreColor', false, document.getElementById('text-color').value);}
function changeBg(){document.execCommand('backColor', false, document.getElementById('bg-color').value);}
function boldText(){document.execCommand('bold');}
function italicText(){document.execCommand('italic');}
function underlineText(){document.execCommand('underline');}
function strikeText(){document.execCommand('strikeThrough');}
function alignLeft(){document.execCommand('justifyLeft');}
function alignCenter(){document.execCommand('justifyCenter');}
function alignRight(){document.execCommand('justifyRight');}
function justifyText(){document.execCommand('justifyFull');}
function insertBullet(){document.execCommand('insertUnorderedList');}
function insertNumber(){document.execCommand('insertOrderedList');}
function insertEmoji(){document.execCommand('insertText',false,'üòä');}
function undo(){document.execCommand('undo');}
function redo(){document.execCommand('redo');}
function saveAs(){
  let content=document.getElementById('editor').innerHTML;
  const blob=new Blob([content],{type:"text/html"});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);a.download='PartexDocument.html';a.click();
}
function newDocument(){document.getElementById('editor').innerHTML='';}
function openDocument(){
  let input=document.createElement('input');input.type='file';input.accept='.html,.txt';
  input.onchange=e=>{
    let file=e.target.files[0];
    let reader=new FileReader();
    reader.onload=function(ev){document.getElementById('editor').innerHTML=ev.target.result;}
    reader.readAsText(file);
  };
  input.click();
}

// ---------------- Presenter ----------------
let slides=[],currentSlide=0;
function openPresenter(){
  document.getElementById('dashboard').style.display='none';
  document.getElementById('app-container').style.display='block';
  document.getElementById('writer-menu').style.display='none';
  document.getElementById('presenter-menu').style.display='flex';
  document.getElementById('editor').style.display='none';
  document.getElementById('slides-container').style.display='block';
  if(slides.length===0)addSlide();
  showSlide(currentSlide);
}
function addSlide(){const slide=document.createElement('div');slide.className='slide';slide.contentEditable=true;slide.innerText='Neue Folie';document.getElementById('slides-container').appendChild(slide);slides.push(slide);currentSlide=slides.length-1;showSlide(currentSlide);}
function showSlide(index){slides.forEach((s,i)=>s.classList.remove('active'));if(slides[index])slides[index].classList.add('active');}
function nextSlide(){if(currentSlide<slides.length-1)currentSlide++;showSlide(currentSlide);}
function prevSlide(){if(currentSlide>0)currentSlide--;showSlide(currentSlide);}
function addTextBox(){const tb=document.createElement('div');tb.contentEditable=true;tb.innerText='Textbox';tb.style.position='absolute';tb.style.top='50px';tb.style.left='50px';tb.style.padding='10px';tb.style.background='rgba(255,255,255,0.8)';tb.style.border='1px solid #ccc';tb.className='slide-textbox';if(slides[currentSlide])slides[currentSlide].appendChild(tb);}
function removeTextBox(){let tbs=document.querySelectorAll('.slide-textbox');if(tbs.length>0)tbs[tbs.length-1].remove();}
function fullscreenSlide(){if(slides[currentSlide])slides[currentSlide].requestFullscreen();}
function changeSlideBg(){if(slides[currentSlide])slides[currentSlide].style.background=document.getElementById('slide-bg').value;}
function downloadSlides(){let content=slides.map(s=>s.innerText).join('\n\n');const blob=new Blob([content],{type:"text/plain"});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='PartexSlides.txt';a.click();}

// ---------------- Autosave ----------------
setInterval(()=>{
  if(document.getElementById('autosave-writer')?.checked){localStorage.setItem('partex-content',document.getElementById('editor').innerHTML);}
  if(document.getElementById('autosave-presenter')?.checked && slides.length>0){slides.forEach((s,i)=>localStorage.setItem(`slide-${i}`,s.innerHTML));}
},5000);

</script>
</body>
</html>
